---
title: "03_analytic_data"
author: "Puvvula"
date: "2023-07-18"
output: pdf_document
---

```{r}
library(pacman)
pacman::p_load(tidyverse, janitor)

dat <- "~/Documents/ope_ssis/data/"
res<- "~/Documents/ope_ssis/result/"
```

#join exposure, outcome and covars
```{r}
df<- full_join(exp_dat, out_cov, by="participant_id") |>
  filter(if_any(14:27, ~ !is.na(.)))

write_csv(df, paste0(dat, "analytic_set.csv"))
```

#summary of analytic dataset
```{r}
summary_stats<- dat |>
  select(-c(1)) |>
  select(where(is.numeric)) |>
  pivot_longer(everything(), names_to = "metric", values_to = "value") |>
  group_by(metric) |>
   summarize(pct_na = round(sum(is.na(value)/n()*100),2),
             median_conc = round(median(value, na.rm = TRUE), 2),
             percentile_25 = round(quantile(value, 0.25, na.rm = TRUE), 2),
             percentile_75 = round(quantile(value, 0.75, na.rm = TRUE), 2))

write_csv(summary_stats, paste0(res, "summary_analytic_dat.csv"))
```





